<Window x:Class="CompMs.App.Msdial.View.Dims.IonTableViewer"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:CompMs.App.Msdial.View.Dims"
        mc:Ignorable="d"
        xmlns:vm="clr-namespace:CompMs.App.Msdial.ViewModel.Dims"
        xmlns:rs="clr-namespace:CompMs.Graphics.UI.RangeSlider;assembly=ChartDrawing"
        d:DataContext="{d:DesignInstance Type={x:Type vm:AlignmentDimsVM}}"
        Title="Ion table" Height="450" Width="800">
    <Window.Resources>
        <Style TargetType="{x:Type rs:RangeSlider}">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type rs:RangeSlider}">
                        <Grid>
                            <Grid.Resources>
                                <ControlTemplate x:Key="simpleSlider" TargetType="Slider">
                                    <Border SnapsToDevicePixels="True"
                                            BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}">
                                        <Grid>
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto" MinHeight="{TemplateBinding MinHeight}"/>
                                                <RowDefinition Height="Auto"/>
                                            </Grid.RowDefinitions>
                                            <Rectangle x:Name="PART_SelectionRange"/>
                                            <Track x:Name="PART_Track" Grid.Row="1">
                                                <Track.Thumb>
                                                    <Thumb x:Name="Thumb">
                                                        <Thumb.Template>
                                                            <ControlTemplate TargetType="Thumb">
                                                                <Rectangle Fill="{x:Static SystemColors.ControlBrush}"
                                                                           Stroke="{x:Static SystemColors.ActiveBorderBrush}"
                                                                           StrokeThickness="1"
                                                                           Width="10" Height="18"
                                                                           SnapsToDevicePixels="True"/>
                                                            </ControlTemplate>
                                                        </Thumb.Template>
                                                    </Thumb>
                                                </Track.Thumb>
                                            </Track>
                                        </Grid>
                                    </Border>
                                </ControlTemplate>
                            </Grid.Resources>

                            <Grid.RowDefinitions>
                                <RowDefinition/>
                                <RowDefinition/>
                            </Grid.RowDefinitions>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition/>
                                <ColumnDefinition/>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition/>
                                <ColumnDefinition/>
                            </Grid.ColumnDefinitions>

                            <TextBox Text="{Binding LowerValue, RelativeSource={RelativeSource AncestorType={x:Type rs:RangeSlider}}}"
                                     TextAlignment="Center"
                                     Grid.Row="0" Grid.Column="0" Grid.ColumnSpan="2"/>
                            <TextBlock Text="m/z range"
                                       Margin="10,0"
                                       Grid.Row="0" Grid.Column="2"/>
                            <TextBox Text="{Binding UpperValue, RelativeSource={RelativeSource AncestorType={x:Type rs:RangeSlider}}}"
                                     TextAlignment="Center"
                                     Grid.Row="0" Grid.Column="3" Grid.ColumnSpan="2"/>

                            <Rectangle Fill="{x:Static SystemColors.ControlBrush}"
                                       Stroke="{x:Static SystemColors.ActiveBorderBrush}"
                                       StrokeThickness="1"
                                       VerticalAlignment="Center"
                                       Height="5" Margin="5,0"
                                       Grid.Row="1" Grid.Column="1" Grid.ColumnSpan="3"/>
                            <Slider x:Name="PART_LowerRange"
                                    Minimum="{Binding Minimum, RelativeSource={RelativeSource AncestorType={x:Type rs:RangeSlider}}}"
                                    Maximum="{Binding Maximum, RelativeSource={RelativeSource AncestorType={x:Type rs:RangeSlider}}}"
                                    Value="{Binding LowerValue, RelativeSource={RelativeSource AncestorType={x:Type rs:RangeSlider}}}"
                                    VerticalAlignment="Center"
                                    Template="{StaticResource simpleSlider}"
                                    Margin="0,0,10,0"
                                    Grid.Row="1" Grid.Column="1" Grid.ColumnSpan="3"/>
                            <Slider x:Name="PART_UpperRange"
                                    Minimum="{Binding Minimum, RelativeSource={RelativeSource AncestorType={x:Type rs:RangeSlider}}}"
                                    Maximum="{Binding Maximum, RelativeSource={RelativeSource AncestorType={x:Type rs:RangeSlider}}}"
                                    Value="{Binding UpperValue, RelativeSource={RelativeSource AncestorType={x:Type rs:RangeSlider}}}"
                                    VerticalAlignment="Center"
                                    Template="{StaticResource simpleSlider}"
                                    Margin="10,0,0,0"
                                    Grid.Row="1" Grid.Column="1" Grid.ColumnSpan="3"/>
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Window.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="50" MinHeight="50"/>
            <RowDefinition />
        </Grid.RowDefinitions>

        <Grid Margin="5" Grid.Row="0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="110"/>
                <ColumnDefinition />
                <ColumnDefinition />
                <ColumnDefinition Width="180"/>
            </Grid.ColumnDefinitions>

            <StackPanel Grid.Column="0">
                <StackPanel Orientation="Horizontal">
                    <TextBlock Text="Num of rows:"/>
                    <TextBlock Text="{Binding Ms1Spots.Count}"/>
                </StackPanel>
                <StackPanel Orientation="Horizontal">
                    <StackPanel.Resources>
                        <Style TargetType="Button">
                            <Setter Property="Height" Value="20"/>
                            <Setter Property="Width" Value="20"/>
                            <Setter Property="Margin" Value="0,0,2,0"/>
                        </Style>
                    </StackPanel.Resources>
                    <Button IsEnabled="False"/>
                    <Button IsEnabled="False"/>
                    <Button IsEnabled="False"/>
                    <Button IsEnabled="False"/>
                    <Button IsEnabled="False"/>
                </StackPanel>
            </StackPanel>

            <StackPanel Margin="5,0,0,0"
                        Grid.Column="1">
                <TextBlock Text="Metabolite Name Filter"/>
                <TextBox Text="" HorizontalAlignment="Stretch" IsEnabled="False"/>
            </StackPanel>

            <StackPanel Margin="5,0,0,0"
                        Grid.Column="2">
                <TextBlock Text="Comment Filter"/>
                <TextBox Text="" HorizontalAlignment="Stretch" IsEnabled="False"/>
            </StackPanel>

            <rs:RangeSlider Minimum="{Binding MassMin, Mode=OneWay}"
                            Maximum="{Binding MassMax, Mode=OneWay}"
                            LowerValue="{Binding MassLower, Mode=TwoWay}"
                            UpperValue="{Binding MassUpper, Mode=TwoWay}"
                            Margin="8,0" Grid.Column="3"/>
        </Grid>

        <DataGrid ItemsSource="{Binding Ms1Spots}"
                  IsSynchronizedWithCurrentItem="True"
                  CanUserAddRows="False" CanUserDeleteRows="False"
                  CanUserReorderColumns="False" CanUserSortColumns="True"
                  SelectionUnit="FullRow"
                  HeadersVisibility="All"
                  AutoGenerateColumns="False"
                  VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Auto"
                  Grid.Row="1">

            <DataGrid.ColumnHeaderStyle>
                <Style TargetType="DataGridColumnHeader">
                    <Setter Property="HorizontalContentAlignment" Value="Center"/>
                </Style>
            </DataGrid.ColumnHeaderStyle>
            <DataGrid.CellStyle>
                <Style TargetType="DataGridCell">
                    <Setter Property="HorizontalContentAlignment" Value="Center"/>
                    <Setter Property="TextBlock.TextAlignment" Value="Center"/>
                </Style>
            </DataGrid.CellStyle>

            <DataGrid.Columns>
                <DataGridTextColumn Header="ID"
                                    Binding="{Binding Path=AlignmentID}"
                                    IsReadOnly="True" 
                                    Width="50" />
                <DataGridTextColumn Header="m/z"
                                    Binding="{Binding Path=MassCenter, StringFormat=0.0000}"
                                    IsReadOnly="True"
                                    Width="70" />
                <DataGridTextColumn Header="Type"
                                    Binding="{Binding Path=AdductIonName}"
                                    IsReadOnly="True"
                                    Width="1*" />
                <DataGridTextColumn Header="Fill %"
                                    Binding="{Binding Path=FillPercentage, StringFormat=0.00}"
                                    IsReadOnly="True"
                                    Width="50" />
                <DataGridTextColumn Header="Metabolite name"
                                    Binding="{Binding Path=Name}"
                                    IsReadOnly="False"
                                    Width="2*" >
                    <DataGridTextColumn.CellStyle>
                        <Style TargetType="{x:Type DataGridCell}">
                            <Setter Property="TextBlock.TextAlignment" Value="Left"/>
                        </Style>
                    </DataGridTextColumn.CellStyle>
                </DataGridTextColumn>

                <DataGridTextColumn Header="Comment"
                                    Binding="{Binding Path=Comment}"
                                    IsReadOnly="False"
                                    Width="2*" />
                <DataGridTextColumn Header="S/N"
                                    Binding="{Binding Path=SignalToNoiseAve, StringFormat=0.0}"
                                    IsReadOnly="True"
                                    Width="1*" />
                <DataGridTextColumn Header="ANOVA&#13;P-value"
                                    Width="80"
                                    Binding="{Binding Path=AnovaPvalue, StringFormat=0.00E00}"
                                    IsReadOnly="True" />
                <DataGridTextColumn Header="Fold change&#13;(Max/Min)"
                                    Width="80"
                                    Binding="{Binding Path=FoldChange, StringFormat=0.00}"
                                    IsReadOnly="True" />
                <DataGridTemplateColumn Header="BarChart"
                                        Width="150">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <local:AlignmentClassBar/>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>
            </DataGrid.Columns>

        </DataGrid>
    </Grid>
</Window>
