<UserControl x:Class="CompMs.App.Msdial.View.Setting.DatasetSettingView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:converter="clr-namespace:CompMs.CommonMVVM.Converter;assembly=CommonMVVM"
             xmlns:ui="clr-namespace:CompMs.Graphics.UI;assembly=ChartDrawing"
             mc:Ignorable="d" 
             d:Background="White"
             d:DesignHeight="800" d:DesignWidth="800">
    <UserControl.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="/View/MainWindowStyle.xaml"/>
            </ResourceDictionary.MergedDictionaries>
            <converter:BooleanToEnumConverter x:Key="BooleanToEnum"/>
        </ResourceDictionary>
    </UserControl.Resources>

    <StackPanel>
        <ui:ExecutableBar Label="Raw measurement folder:"
                          LabelWidth="160"
                          ButtonContent="Browse"
                          ButtonWidth="64"
                          Command="{Binding ProjectFolderSelectCommand}"
                          ToolTip="Select a folder which should be the same as the directory includeing measurement files.">
            <TextBox Style="{StaticResource ToolTipErrorStyle}"
                     d:Text="/measurement/folder/path"
                     Text="{Binding Path=ProjectFilePath, UpdateSourceTrigger=PropertyChanged}"
                     VerticalContentAlignment="Center" Margin="8,0"/>
        </ui:ExecutableBar>

        <GroupBox Header="Ionization type" Padding="4">
            <StackPanel>
                <RadioButton Name="RadioButton_ESI"
                             Content="Soft ionization (LC/MS, LC/MS/MS, or precursor-oriented GC/MS/MS)"
                             d:IsChecked="True"
                             IsChecked="{Binding Ionization, Converter={StaticResource BooleanToEnum}, ConverterParameter=ESI, Mode=TwoWay}"
                             Margin="8,0,0,0"
                             ToolTip="Type 1: When you analyze an ESI type data like LC/MS or LS/MS/MS, select this option."
                             Grid.Row="0"/>
                <RadioButton Name="RadioButton_EI"
                             Content="Hard ionization (GC/MS)"
                             IsChecked="{Binding Ionization, Converter={StaticResource BooleanToEnum}, ConverterParameter=EI, Mode=TwoWay}"
                             Margin="8,8,0,0"
                             ToolTip="Type 2: When you analyze an EI type data like GC/MS, select this option."
                             Grid.Row="1"/>
            </StackPanel>
        </GroupBox>

        <GroupBox Header="Separation type" Padding="4">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition/>
                    <ColumnDefinition/>
                </Grid.ColumnDefinitions>

                <RadioButton Name="RadioButton_Separation_GCorLC"
                             Content="Chromatography (GC, LC, CE, or SFC)"
                             d:IsChecked="True"
                             IsChecked="{Binding SeparationChromatography, Mode=TwoWay}"
                             Margin="8,0,0,0"
                             ToolTip="Type 1: When you analyze GC or LC data, please select this option."
                             Grid.Row="0" Grid.Column="0"/>
                <RadioButton Name="RadioButton_Infusion"
                             Content="Direct infusion"
                             IsChecked="{Binding DirectInfution, Mode=TwoWay}"
                             Margin="8,0,0,0"
                             ToolTip="Type 3: When you analyze direct infusion data, please select this option"
                             Grid.Row="0" Grid.Column="1"/>

                <CheckBox Name="RadioButton_Separation_LCIM"
                          Content="Ion mobility (now coupled with liquid chromatography or direct infusion)"
                          IsChecked="{Binding SeparationIonMobility, Mode=TwoWay}"
                          Margin="8,8,0,0"
                          ToolTip="Type 2: When you analyze LC-IM or IM (ion mobility data), please select this option."
                          Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="2"/>
            </Grid>
        </GroupBox>

        <GroupBox Name="GroupBox_MethodType"
                  Header="MS method type"
                  IsEnabled="{Binding IsChecked, ElementName=RadioButton_ESI}"
                  Padding="4">
            <StackPanel>
                <RadioButton Name="RadioButton_DataDependentMSMS" 
                             Content="Conventional LC/MS or data dependent MS/MS" 
                             IsChecked="{Binding AcquisitionType, Converter={StaticResource BooleanToEnum}, ConverterParameter=DDA}"
                             d:IsChecked="True"
                             Margin="8,0,0,0"
                             ToolTip="Type 1: When you analyze a data set from data dependent MS/MS, select this option."
                             Grid.Row="0"/>

                <Grid Margin="0,8,0,0" Grid.Row="1" d:Visibility="Visible">
                    <Grid.Style>
                        <Style TargetType="Grid">
                            <Setter Property="Visibility" Value="Collapsed"/>
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding SeparationIonMobility}" Value="False">
                                    <Setter Property="Visibility" Value="Visible"/>
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </Grid.Style>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition/>
                        <ColumnDefinition/>
                    </Grid.ColumnDefinitions>
                    <RadioButton Name="RadioButton_DataIndependentMSMS_SWATH" 
                                 Content="SWATH-MS or conventional All-ions method" 
                                 IsChecked="{Binding AcquisitionType, Converter={StaticResource BooleanToEnum}, ConverterParameter=SWATH}"
                                 Margin="8,0,0,0"
                                 Grid.Column="0">
                        <ToolTipService.ToolTip>
                            <TextBlock>
                                Type 2:<LineBreak />
                                When you analyze a data set from data independent MS/MS, select this option. <LineBreak />
                                Moreover, you have to import the experiment information including <LineBreak />
                                &quot;Experiment ID&quot;, &quot;Scan or Swath&quot;, and &quot;Mass range&quot;.<LineBreak />
                                Please see the downloadable format.<LineBreak />
                                For SWATH users, utilize &quot;Sample Information&quot; of PeakView software.<LineBreak />
                                It's quite easy to get that kind of information.
                            </TextBlock>
                        </ToolTipService.ToolTip>
                    </RadioButton>

                    <RadioButton x:Name="RadioButton_DataIndependentMSMS_AIF"
                                 Content="All-ions with multiple CEs (cycled like 0V-10V-40V)"
                                 IsChecked="{Binding AcquisitionType, Converter={StaticResource BooleanToEnum}, ConverterParameter=AIF}"
                                 Margin="8,0,0,0"
                                 Grid.Column="1">
                        <ToolTipService.ToolTip>
                            <TextBlock>
                                Type 3:<LineBreak />
                                When you analyze a data set from data independent MS/MS, select this option.<LineBreak />
                                Moreover, you have to import the experiment information including<LineBreak />
                                &quot;Experiment ID&quot;, &quot;Scan or AIF&quot;, &quot;Mass range&quot;, &quot;Name&quot; and &quot;Deconvolution Target (1:Yes, 0:No)&quot;.<LineBreak />
                                Please see the downloadable format..
                            </TextBlock>
                        </ToolTipService.ToolTip>
                    </RadioButton>
                </Grid>

                <RadioButton Name="RadioButton_DataIndependentMSMS" 
                             Content="Data independent MS/MS" 
                             IsChecked="{Binding AcquisitionType, Converter={StaticResource BooleanToEnum}, ConverterParameter=SWATH}"
                             Visibility="{Binding IsChecked, ElementName=RadioButton_Separation_LCIM, Converter={StaticResource boolean2visibility}}"
                             d:Visibility="Visible"
                             Margin="8,8,0,0"
                             Grid.Row="2">
                    <ToolTipService.ToolTip>
                        <TextBlock>
                            Type 2:<LineBreak /> 
                            When you analyze a data set from data independent MS/MS, select this option. 
                        </TextBlock>
                    </ToolTipService.ToolTip>
                </RadioButton>
            </StackPanel>
        </GroupBox>

        <GroupBox Header="Collision type"
                  Visibility="{Binding IsChecked, ElementName=RadioButton_DataDependentMSMS, Converter={StaticResource boolean2visibility}}"
                  Grid.Row="4">
            <UniformGrid Columns="2">
                <RadioButton Content="CID, HCD"
                             IsChecked="{Binding CollisionType, Converter={StaticResource BooleanToEnum}, ConverterParameter=HCD}"/>
                <RadioButton Content="EAD"
                             IsChecked="{Binding CollisionType, Converter={StaticResource BooleanToEnum}, ConverterParameter=EAD}"/>
            </UniformGrid>
        </GroupBox>

        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="*" />
            </Grid.ColumnDefinitions>

            <GroupBox Name="GroupBox_DataType"
                      Header="Data type (MS1)"
                      Padding="4"
                      Grid.Column="0">
                <StackPanel>
                    <RadioButton Name="RadioButton_ProfileMode"
                                 Content="Profile data"
                                 IsChecked="{Binding MS1DataType, Converter={StaticResource BooleanToEnum}, ConverterParameter=Profile}"
                                 Margin="8,0,0,0">
                        <ToolTipService.ToolTip>
                            <TextBlock>
                                Check carefully this option for your own data sets. Usually, as long as you use abf converter, please set this option as follows:<LineBreak />
                                AB Sciex: Profile<LineBreak />
                                Agilent LC-QTOF: Centroid<LineBreak />
                                Bruker LC-QTOF or FT-ICR: Centroid<LineBreak />
                                Thermo Orbitrap: Profile<LineBreak />
                                Waters LC-QTOF: Centroid<LineBreak />
                                mzML: up to your setting in ProteoWizard.<LineBreak />
                                However, the above setting actually depends on your instrument setting.<LineBreak />
                                As long as you use the default sets, the above should be fine.<LineBreak />
                                If not, please set Centroid first by a file, and look at the peak shape if it's like centroid or profile.
                            </TextBlock>
                        </ToolTipService.ToolTip>
                    </RadioButton>

                    <RadioButton Name="RadioButton_CentroidMode"
                                 Content="Centroid data"
                                 IsChecked="{Binding MS1DataType, Converter={StaticResource BooleanToEnum}, ConverterParameter=Centroid}"
                                 d:IsChecked="True"
                                 Margin="8,8,0,0">
                        <ToolTipService.ToolTip>
                            <TextBlock>
                                Check carefully this option for your own data sets. Usually, as long as you use abf converter, please set this option as follows:<LineBreak />
                                AB Sciex: Profile<LineBreak />
                                Agilent LC-QTOF: Centroid<LineBreak />
                                Bruker LC-QTOF or FT-ICR: Centroid<LineBreak />
                                Thermo Orbitrap: Profile<LineBreak />
                                Waters LC-QTOF: Centroid<LineBreak />
                                mzML: up to your setting in ProteoWizard.<LineBreak />
                                However, the above setting actually depends on your instrument setting.<LineBreak />
                                As long as you use the default sets, the above should be fine.<LineBreak />
                                If not, please set Centroid first by a file, and look at the peak shape if it's like centroid or profile.
                            </TextBlock>
                        </ToolTipService.ToolTip>
                    </RadioButton>
                </StackPanel>
            </GroupBox>

            <GroupBox Name="GroupBox_DataTypeMS2"
                      Header="Data type (MS/MS)"
                      IsEnabled="{Binding IsChecked, ElementName=RadioButton_ESI}"
                      Padding="4"
                      Grid.Column="1">
                <StackPanel>
                    <RadioButton Name="RadioButton_ProfileModeMS2"
                                 Content="Profile data"
                                 IsChecked="{Binding MS2DataType, Converter={StaticResource BooleanToEnum}, ConverterParameter=Profile}"
                                 Margin="8,0,0,0">
                        <ToolTipService.ToolTip>
                            <TextBlock>
                                Basically, select the same mode as the data type of MS1.<LineBreak />
                                The reason why we separated the mode selections is that we found that Thermo LTQ-Orbitrap often stores the different data types<LineBreak />
                                in MS1 and MS/MS. Most frequent is that MS1 should be 'profile' mode while MS/MS should be 'centroid' mode.
                            </TextBlock>
                        </ToolTipService.ToolTip>
                    </RadioButton>

                    <RadioButton Name="RadioButton_CentroidModeMS2"
                                 Content="Centroid data"
                                 IsChecked="{Binding MS2DataType, Converter={StaticResource BooleanToEnum}, ConverterParameter=Centroid}"
                                 d:IsChecked="True"
                                 Margin="8,8,0,0">
                        <ToolTipService.ToolTip>
                            <TextBlock>
                                Basically, select the same mode as the data type of MS1.<LineBreak />
                                The reason why we separated the mode selections is that we found that Thermo LTQ-Orbitrap often stores the different data types<LineBreak />
                                in MS1 and MS/MS. Most frequent is that MS1 should be 'profile' mode while MS/MS should be 'centroid' mode.
                            </TextBlock>
                        </ToolTipService.ToolTip>
                    </RadioButton>
                </StackPanel>
            </GroupBox>
        </Grid>

        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="*" />
            </Grid.ColumnDefinitions>

            <GroupBox Name="GroupBox_IonMode"
                      Header="Ion mode"
                      Padding="4"
                      Grid.Column="0">
                <StackPanel>
                    <RadioButton Name="RadioButton_PositiveMode"
                                 Content="Positive ion mode"
                                 IsChecked="{Binding IonMode, Converter={StaticResource BooleanToEnum}, ConverterParameter=Positive}"
                                 d:IsChecked="True"
                                 Margin="8,0,0,0"
                                 ToolTip="Necessary for adduct ion setting"/>
                    <RadioButton Name="RadioButton_NegativeMode"
                                 Content="Negative ion mode"
                                 IsChecked="{Binding IonMode, Converter={StaticResource BooleanToEnum}, ConverterParameter=Negative}"
                                 Margin="8,8,0,0"
                                 ToolTip="Necessary for adduct ion setting"/>
                </StackPanel>
            </GroupBox>

            <GroupBox Name="GroupBox_TargetOmics"
                      Header="Target omics"
                      Padding="4"
                      Grid.Column="1">
                <StackPanel>
                    <RadioButton Name="RadioButton_Metabolomics"
                                 Content="Metabolomics"
                                 IsChecked="{Binding TargetOmics, Converter={StaticResource BooleanToEnum}, ConverterParameter=Metabolomics}"
                                 Margin="8,0,0,0">
                        <ToolTipService.ToolTip>
                            <TextBlock>
                                Identification method is optimized for metabolomics.<LineBreak />
                                You have to use your own spectral (MSP) library for compound identifications.
                            </TextBlock>
                        </ToolTipService.ToolTip>
                    </RadioButton>
                    <RadioButton Name="RadioButton_Lipidomics"
                                 Content="Lipidomics"
                                 d:IsChecked="True"
                                 IsChecked="{Binding TargetOmics, Converter={StaticResource BooleanToEnum}, ConverterParameter=Lipidomics}"
                                 IsEnabled="{Binding IsChecked, ElementName=RadioButton_ESI}"
                                 Margin="8,8,0,0"
                                 ToolTip="The analysis procedure is optimized for lipidomics."/>
                    <RadioButton Name="RadioButton_Proteomics"
                                 Content="Proteomics"
                                 IsChecked="{Binding TargetOmics, Converter={StaticResource BooleanToEnum}, ConverterParameter=Proteomics}"
                                 IsEnabled="{Binding IsChecked, ElementName=RadioButton_ESI}"
                                 Margin="8,8,0,0"
                                 ToolTip="The analysis procedure is optimized for proteomics."/>
                </StackPanel>
            </GroupBox>
        </Grid>

        <Expander Header="Advanced: add further meta data"
                  d:IsExpanded="True"
                  ExpandDirection="Down">
            <StackPanel>
                <Label Content="----Optional information for MassBank-, MoNA-, and NIST (MSP) format export----"
                       FontStyle="Italic"
                       HorizontalAlignment="Center"
                       Margin="8,0,0,0" />
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition/>
                        <ColumnDefinition/>
                    </Grid.ColumnDefinitions>

                    <StackPanel Grid.Column="0">
                        <StackPanel.Resources>
                            <Style TargetType="TextBox" BasedOn="{StaticResource ResourceKey=ToolTipErrorStyle}">
                                <Setter Property="Height" Value="24"/>
                                <Setter Property="Margin" Value="4"/>
                                <Setter Property="VerticalContentAlignment" Value="Center"/>
                            </Style>
                            <Style TargetType="ui:LabeledBar">
                                <Setter Property="LabelWidth" Value="104"/>
                            </Style>
                        </StackPanel.Resources>
                        <ui:LabeledBar Label="Instrument trype:">
                            <TextBox Name="TextBox_InstrumentType" 
                                     Text="{Binding InstrumentType, UpdateSourceTrigger=PropertyChanged}"
                                     d:Text="Instrument type"
                                     ToolTip="GC-EI-TOF, LC-ESI-QTOF etc. See MassBank definition"/>
                        </ui:LabeledBar>
                        <ui:LabeledBar Label="Instrument:">
                            <TextBox Name="TextBox_Instrument" 
                                     Text="{Binding Instrument, UpdateSourceTrigger=PropertyChanged}"
                                     d:Text="Instrument"
                                     ToolTip="ex. LTQ Orbitrap XL, Thermo Scientfic; HP-1100 HPLC, Agilent"/>
                        </ui:LabeledBar>
                        <ui:LabeledBar Label="Authors:">
                            <TextBox Name="TextBox_Authors" 
                                     Text="{Binding Authors, UpdateSourceTrigger=PropertyChanged}"
                                     d:Text="Author"
                                     ToolTip="ex. Hiroshi Tsugawa, Kazutaka Ikeda, and Makoto Arita"/>
                        </ui:LabeledBar>
                        <ui:LabeledBar Label="License:">
                            <TextBox Name="TextBox_License" 
                                     Text="{Binding License, UpdateSourceTrigger=PropertyChanged}"
                                     d:Text="License"
                                     ToolTip="ex. CC-BY"/>
                        </ui:LabeledBar>
                        <ui:LabeledBar Label="Collision energy:">
                            <TextBox Name="TextBox_CollisionEnergy" 
                                     Text="{Binding CollisionEnergy, UpdateSourceTrigger=PropertyChanged}"
                                     d:Text="Collision energy"
                                     ToolTip="ex. 70 eV (in GC-MS), 30 +/-15 V (in MS/MS)"/>
                        </ui:LabeledBar>
                    </StackPanel>

                    <DockPanel Grid.Column="1">
                        <Label Content="Comment:" Margin="8,4,0,0" DockPanel.Dock="Left"/>
                        <TextBox Name="TextBox_Comment"
                                 Text="{Binding Path=Comment, UpdateSourceTrigger=PropertyChanged}" 
                                 AcceptsReturn="True"
                                 VerticalScrollBarVisibility="Auto"
                                 TextWrapping="WrapWithOverflow" 
                                 Margin="8,4,0,0"
                                 ToolTip="Add comment."/>
                    </DockPanel>
                </Grid>
            </StackPanel>
        </Expander>

        <Button Name="Button_Next" 
                Content="Next" 
                Command="{Binding ContinueProcessCommand, UpdateSourceTrigger=PropertyChanged}" 
                CommandParameter="{Binding ElementName=StartUpWindowView}"
                Width="64" Height="24" 
                Margin="4,4,4,0"
                HorizontalAlignment="Right"/>
    </StackPanel>
</UserControl>
