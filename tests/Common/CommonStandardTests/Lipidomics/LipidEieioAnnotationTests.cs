using CompMs.Common.Components;
using CompMs.Common.DataObj.Property;
using CompMs.Common.DataObj.Result;
using CompMs.Common.Enum;
using CompMs.Common.Parameter;
using CompMs.Common.Parser;
using Microsoft.VisualStudio.TestTools.UnitTesting;
using System;
using System.Collections.Generic;
using System.Linq;

namespace CompMs.Common.Lipidomics.Tests
{
    [TestClass()]
    public class LipidEieioAnnotationTests
    {

        [TestMethod()]
        public void MGEieioCharacterizationTest()
        {
            var target = new MSScanProperty
            {
                PrecursorMz = 346.29431,
                Spectrum = new List<SpectrumPeak>
                {
                    new SpectrumPeak { Mass = 101.05762, Intensity =9, },
                    new SpectrumPeak { Mass = 105.06855, Intensity =7, },
                    new SpectrumPeak { Mass = 107.08505, Intensity =31, },
                    new SpectrumPeak { Mass = 108.09244, Intensity =51, },
                    new SpectrumPeak { Mass = 109.10046, Intensity =35, },
                    new SpectrumPeak { Mass = 110.10968, Intensity =64, },
                    new SpectrumPeak { Mass = 111.08007, Intensity =33, },
                    new SpectrumPeak { Mass = 112.08676, Intensity =16, },
                    new SpectrumPeak { Mass = 113.09565, Intensity =17, },
                    new SpectrumPeak { Mass = 115.07416, Intensity =7, },
                    new SpectrumPeak { Mass = 119.08412, Intensity =55, },
                    new SpectrumPeak { Mass = 120.09486, Intensity =80, },
                    new SpectrumPeak { Mass = 121.10183, Intensity =85, },
                    new SpectrumPeak { Mass = 122.10794, Intensity =33, },
                    new SpectrumPeak { Mass = 123.11836, Intensity =108, },
                    new SpectrumPeak { Mass = 124.09007, Intensity =32, },
                    new SpectrumPeak { Mass = 124.12666, Intensity =10, },
                    new SpectrumPeak { Mass = 125.00219, Intensity =38, },
                    new SpectrumPeak { Mass = 125.0956, Intensity =33, },
                    new SpectrumPeak { Mass = 126.10284, Intensity =73, },
                    new SpectrumPeak { Mass = 127.10251, Intensity =55, },
                    new SpectrumPeak { Mass = 129.05456, Intensity =320, },
                    new SpectrumPeak { Mass = 130.06162, Intensity =57, },
                    new SpectrumPeak { Mass = 131.08491, Intensity =93, },
                    new SpectrumPeak { Mass = 132.01747, Intensity =90, },
                    new SpectrumPeak { Mass = 132.09205, Intensity =12, },
                    new SpectrumPeak { Mass = 133.10021, Intensity =176, },
                    new SpectrumPeak { Mass = 134.08772, Intensity =10, },
                    new SpectrumPeak { Mass = 134.10686, Intensity =251, },
                    new SpectrumPeak { Mass = 134.30336, Intensity =10, },
                    new SpectrumPeak { Mass = 135.11849, Intensity =729, },
                    new SpectrumPeak { Mass = 136.08974, Intensity =10, },
                    new SpectrumPeak { Mass = 136.12188, Intensity =64, },
                    new SpectrumPeak { Mass = 137.09742, Intensity =402, },
                    new SpectrumPeak { Mass = 138.10322, Intensity =117, },
                    new SpectrumPeak { Mass = 138.13918, Intensity =71, },
                    new SpectrumPeak { Mass = 139.11211, Intensity =98, },
                    new SpectrumPeak { Mass = 140.1174, Intensity =83, },
                    new SpectrumPeak { Mass = 141.09766, Intensity =39, },
                    new SpectrumPeak { Mass = 141.12742, Intensity =11, },
                    new SpectrumPeak { Mass = 141.92573, Intensity =10, },
                    new SpectrumPeak { Mass = 142.06455, Intensity =50, },
                    new SpectrumPeak { Mass = 142.08451, Intensity =10, },
                    new SpectrumPeak { Mass = 143.06904, Intensity =188, },
                    new SpectrumPeak { Mass = 144.09229, Intensity =15, },
                    new SpectrumPeak { Mass = 144.11345, Intensity =14, },
                    new SpectrumPeak { Mass = 145.09709, Intensity =51, },
                    new SpectrumPeak { Mass = 145.96774, Intensity =81, },
                    new SpectrumPeak { Mass = 146.1055, Intensity =35, },
                    new SpectrumPeak { Mass = 147.06563, Intensity =57, },
                    new SpectrumPeak { Mass = 147.11111, Intensity =356, },
                    new SpectrumPeak { Mass = 147.95997, Intensity =40, },
                    new SpectrumPeak { Mass = 148.12408, Intensity =274, },
                    new SpectrumPeak { Mass = 149.13141, Intensity =699, },
                    new SpectrumPeak { Mass = 150.10809, Intensity =54, },
                    new SpectrumPeak { Mass = 150.13811, Intensity =10, },
                    new SpectrumPeak { Mass = 151.11206, Intensity =903, },
                    new SpectrumPeak { Mass = 151.1498, Intensity =47, },
                    new SpectrumPeak { Mass = 152.12053, Intensity =608, },
                    new SpectrumPeak { Mass = 153.1264, Intensity =314, },
                    new SpectrumPeak { Mass = 154.13566, Intensity =86, },
                    new SpectrumPeak { Mass = 155.10258, Intensity =70, },
                    new SpectrumPeak { Mass = 155.13857, Intensity =107, },
                    new SpectrumPeak { Mass = 155.62961, Intensity =10, },
                    new SpectrumPeak { Mass = 156.07724, Intensity =10, },
                    new SpectrumPeak { Mass = 156.10784, Intensity =10, },
                    new SpectrumPeak { Mass = 156.97768, Intensity =39, },
                    new SpectrumPeak { Mass = 157.07757, Intensity =10, },
                    new SpectrumPeak { Mass = 157.09231, Intensity =10, },
                    new SpectrumPeak { Mass = 157.12113, Intensity =44, },
                    new SpectrumPeak { Mass = 158.09285, Intensity =12, },
                    new SpectrumPeak { Mass = 158.11312, Intensity =10, },
                    new SpectrumPeak { Mass = 158.97415, Intensity =10, },
                    new SpectrumPeak { Mass = 159.10818, Intensity =30, },
                    new SpectrumPeak { Mass = 160.989, Intensity =10, },
                    new SpectrumPeak { Mass = 161.13235, Intensity =216, },
                    new SpectrumPeak { Mass = 162.13872, Intensity =89, },
                    new SpectrumPeak { Mass = 163.1491, Intensity =354, },
                    new SpectrumPeak { Mass = 164.12035, Intensity =20, },
                    new SpectrumPeak { Mass = 164.13357, Intensity =27, },
                    new SpectrumPeak { Mass = 164.1576, Intensity =10, },
                    new SpectrumPeak { Mass = 165.12667, Intensity =406, },
                    new SpectrumPeak { Mass = 166.13625, Intensity =581, },
                    new SpectrumPeak { Mass = 167.14585, Intensity =227, },
                    new SpectrumPeak { Mass = 168.15065, Intensity =48, },
                    new SpectrumPeak { Mass = 169.08616, Intensity =49, },
                    new SpectrumPeak { Mass = 169.12378, Intensity =110, },
                    new SpectrumPeak { Mass = 170.09397, Intensity =10, },
                    new SpectrumPeak { Mass = 171.10097, Intensity =129, },
                    new SpectrumPeak { Mass = 171.13757, Intensity =35, },
                    new SpectrumPeak { Mass = 172.11405, Intensity =68, },
                    new SpectrumPeak { Mass = 173.12763, Intensity =83, },
                    new SpectrumPeak { Mass = 174.08986, Intensity =15, },
                    new SpectrumPeak { Mass = 174.98905, Intensity =148, },
                    new SpectrumPeak { Mass = 175.14616, Intensity =115, },
                    new SpectrumPeak { Mass = 176.10158, Intensity =136, },
                    new SpectrumPeak { Mass = 176.98897, Intensity =15, },
                    new SpectrumPeak { Mass = 177.16505, Intensity =111, },
                    new SpectrumPeak { Mass = 178.13695, Intensity =12, },
                    new SpectrumPeak { Mass = 178.17096, Intensity =34, },
                    new SpectrumPeak { Mass = 178.96237, Intensity =20, },
                    new SpectrumPeak { Mass = 179.1424, Intensity =204, },
                    new SpectrumPeak { Mass = 180.14963, Intensity =287, },
                    new SpectrumPeak { Mass = 181.15848, Intensity =82, },
                    new SpectrumPeak { Mass = 182.16645, Intensity =29, },
                    new SpectrumPeak { Mass = 183.10716, Intensity =33, },
                    new SpectrumPeak { Mass = 183.13882, Intensity =36, },
                    new SpectrumPeak { Mass = 184.11089, Intensity =10, },
                    new SpectrumPeak { Mass = 185.11922, Intensity =250, },
                    new SpectrumPeak { Mass = 186.13397, Intensity =83, },
                    new SpectrumPeak { Mass = 187.06283, Intensity =10, },
                    new SpectrumPeak { Mass = 187.09533, Intensity =19, },
                    new SpectrumPeak { Mass = 187.13163, Intensity =21, },
                    new SpectrumPeak { Mass = 189.16171, Intensity =59, },
                    new SpectrumPeak { Mass = 190.11617, Intensity =80, },
                    new SpectrumPeak { Mass = 190.16682, Intensity =10, },
                    new SpectrumPeak { Mass = 191.17681, Intensity =21, },
                    new SpectrumPeak { Mass = 192.0222, Intensity =10, },
                    new SpectrumPeak { Mass = 192.18553, Intensity =103, },
                    new SpectrumPeak { Mass = 193.15891, Intensity =707, },
                    new SpectrumPeak { Mass = 194.16737, Intensity =297, },
                    new SpectrumPeak { Mass = 195.17274, Intensity =75, },
                    new SpectrumPeak { Mass = 197.11521, Intensity =10, },
                    new SpectrumPeak { Mass = 197.15252, Intensity =44, },
                    new SpectrumPeak { Mass = 198.14126, Intensity =10, },
                    new SpectrumPeak { Mass = 199.12995, Intensity =42, },
                    new SpectrumPeak { Mass = 199.15033, Intensity =35, },
                    new SpectrumPeak { Mass = 199.16307, Intensity =10, },
                    new SpectrumPeak { Mass = 200.14011, Intensity =20, },
                    new SpectrumPeak { Mass = 200.15977, Intensity =10, },
                    new SpectrumPeak { Mass = 201.00668, Intensity =20, },
                    new SpectrumPeak { Mass = 201.14417, Intensity =52, },
                    new SpectrumPeak { Mass = 203.12693, Intensity =103, },
                    new SpectrumPeak { Mass = 204.13457, Intensity =39, },
                    new SpectrumPeak { Mass = 205.14134, Intensity =10, },
                    new SpectrumPeak { Mass = 206.16163, Intensity =32, },
                    new SpectrumPeak { Mass = 207.174, Intensity =241, },
                    new SpectrumPeak { Mass = 208.03348, Intensity =55, },
                    new SpectrumPeak { Mass = 208.18053, Intensity =72, },
                    new SpectrumPeak { Mass = 208.20769, Intensity =8, },
                    new SpectrumPeak { Mass = 208.95365, Intensity =7, },
                    new SpectrumPeak { Mass = 209.18759, Intensity =23, },
                    new SpectrumPeak { Mass = 211.1314, Intensity =55, },
                    new SpectrumPeak { Mass = 211.16828, Intensity =43, },
                    new SpectrumPeak { Mass = 212.21795, Intensity =8, },
                    new SpectrumPeak { Mass = 213.14605, Intensity =59, },
                    new SpectrumPeak { Mass = 213.18226, Intensity =28, },
                    new SpectrumPeak { Mass = 214.01071, Intensity =10, },
                    new SpectrumPeak { Mass = 214.15911, Intensity =54, },
                    new SpectrumPeak { Mass = 215.01974, Intensity =30, },
                    new SpectrumPeak { Mass = 215.12651, Intensity =12, },
                    new SpectrumPeak { Mass = 215.15685, Intensity =17, },
                    new SpectrumPeak { Mass = 215.18179, Intensity =10, },
                    new SpectrumPeak { Mass = 216.13646, Intensity =44, },
                    new SpectrumPeak { Mass = 217.19295, Intensity =309, },
                    new SpectrumPeak { Mass = 218.20299, Intensity =272, },
                    new SpectrumPeak { Mass = 219.16941, Intensity =10, },
                    new SpectrumPeak { Mass = 219.21317, Intensity =424, },
                    new SpectrumPeak { Mass = 221.1892, Intensity =94, },
                    new SpectrumPeak { Mass = 222.18779, Intensity =10, },
                    new SpectrumPeak { Mass = 223.20672, Intensity =11, },
                    new SpectrumPeak { Mass = 224.17533, Intensity =10, },
                    new SpectrumPeak { Mass = 225.14626, Intensity =10, },
                    new SpectrumPeak { Mass = 225.17978, Intensity =10, },
                    new SpectrumPeak { Mass = 227.1605, Intensity =76, },
                    new SpectrumPeak { Mass = 228.16679, Intensity =87, },
                    new SpectrumPeak { Mass = 229.14426, Intensity =74, },
                    new SpectrumPeak { Mass = 231.16101, Intensity =36, },
                    new SpectrumPeak { Mass = 231.19696, Intensity =10, },
                    new SpectrumPeak { Mass = 232.16715, Intensity =49, },
                    new SpectrumPeak { Mass = 233.18964, Intensity =4, },
                    new SpectrumPeak { Mass = 234.19368, Intensity =30, },
                    new SpectrumPeak { Mass = 234.21161, Intensity =10, },
                    new SpectrumPeak { Mass = 235.20522, Intensity =313, },
                    new SpectrumPeak { Mass = 236.21362, Intensity =3725, },
                    new SpectrumPeak { Mass = 237.21967, Intensity =2475, },
                    new SpectrumPeak { Mass = 238.23604, Intensity =38, },
                    new SpectrumPeak { Mass = 239.1662, Intensity =83, },
                    new SpectrumPeak { Mass = 239.9479, Intensity =10, },
                    new SpectrumPeak { Mass = 240.16732, Intensity =16, },
                    new SpectrumPeak { Mass = 241.17991, Intensity =59, },
                    new SpectrumPeak { Mass = 242.18002, Intensity =10, },
                    new SpectrumPeak { Mass = 242.19594, Intensity =23, },
                    new SpectrumPeak { Mass = 243.15899, Intensity =50, },
                    new SpectrumPeak { Mass = 244.16078, Intensity =10, },
                    new SpectrumPeak { Mass = 245.17653, Intensity =88, },
                    new SpectrumPeak { Mass = 246.17781, Intensity =205, },
                    new SpectrumPeak { Mass = 249.19224, Intensity =10, },
                    new SpectrumPeak { Mass = 250.99829, Intensity =66, },
                    new SpectrumPeak { Mass = 251.01893, Intensity =7, },
                    new SpectrumPeak { Mass = 252.21001, Intensity =19, },
                    new SpectrumPeak { Mass = 252.99568, Intensity =129, },
                    new SpectrumPeak { Mass = 253.21091, Intensity =45, },
                    new SpectrumPeak { Mass = 254.22469, Intensity =94, },
                    new SpectrumPeak { Mass = 255.23218, Intensity =716, },
                    new SpectrumPeak { Mass = 256.20246, Intensity =7, },
                    new SpectrumPeak { Mass = 257.17503, Intensity =52, },
                    new SpectrumPeak { Mass = 257.2456, Intensity =10, },
                    new SpectrumPeak { Mass = 258.18079, Intensity =95, },
                    new SpectrumPeak { Mass = 259.18943, Intensity =87, },
                    new SpectrumPeak { Mass = 260.18911, Intensity =119, },
                    new SpectrumPeak { Mass = 261.21738, Intensity =10, },
                    new SpectrumPeak { Mass = 263.20991, Intensity =10, },
                    new SpectrumPeak { Mass = 263.23834, Intensity =29, },
                    new SpectrumPeak { Mass = 267.19835, Intensity =78, },
                    new SpectrumPeak { Mass = 267.22709, Intensity =85, },
                    new SpectrumPeak { Mass = 268.20666, Intensity =10, },
                    new SpectrumPeak { Mass = 268.23997, Intensity =24, },
                    new SpectrumPeak { Mass = 269.20745, Intensity =30, },
                    new SpectrumPeak { Mass = 271.18813, Intensity =16, },
                    new SpectrumPeak { Mass = 271.20426, Intensity =15, },
                    new SpectrumPeak { Mass = 271.24268, Intensity =53, },
                    new SpectrumPeak { Mass = 272.25603, Intensity =300, },
                    new SpectrumPeak { Mass = 273.20643, Intensity =78, },
                    new SpectrumPeak { Mass = 274.1964, Intensity =9, },
                    new SpectrumPeak { Mass = 275.20671, Intensity =60, },
                    new SpectrumPeak { Mass = 279.01343, Intensity =10, },
                    new SpectrumPeak { Mass = 279.23056, Intensity =122, },
                    new SpectrumPeak { Mass = 280.24167, Intensity =32, },
                    new SpectrumPeak { Mass = 281.20762, Intensity =17, },
                    new SpectrumPeak { Mass = 283.2267, Intensity =13, },
                    new SpectrumPeak { Mass = 285.2018, Intensity =10, },
                    new SpectrumPeak { Mass = 285.26845, Intensity =127, },
                    new SpectrumPeak { Mass = 286.21717, Intensity =26, },
                    new SpectrumPeak { Mass = 287.22119, Intensity =10, },
                    new SpectrumPeak { Mass = 289.22375, Intensity =8, },
                    new SpectrumPeak { Mass = 291.02747, Intensity =16, },
                    new SpectrumPeak { Mass = 292.23826, Intensity =36, },
                    new SpectrumPeak { Mass = 293.02747, Intensity =146, },
                    new SpectrumPeak { Mass = 296.22941, Intensity =13, },
                    new SpectrumPeak { Mass = 296.26162, Intensity =10, },
                    new SpectrumPeak { Mass = 297.24409, Intensity =959, },
                    new SpectrumPeak { Mass = 298.25137, Intensity =10, },
                    new SpectrumPeak { Mass = 299.21682, Intensity =224, },
                    new SpectrumPeak { Mass = 300.23287, Intensity =119, },
                    new SpectrumPeak { Mass = 301.23998, Intensity =10, },
                    new SpectrumPeak { Mass = 309.05889, Intensity =6, },
                    new SpectrumPeak { Mass = 309.22686, Intensity =74, },
                    new SpectrumPeak { Mass = 309.24279, Intensity =96, },
                    new SpectrumPeak { Mass = 310.25175, Intensity =527, },
                    new SpectrumPeak { Mass = 311.26272, Intensity =2796, },
                    new SpectrumPeak { Mass = 312.78699, Intensity =11, },
                    new SpectrumPeak { Mass = 313.26109, Intensity =67, },
                    new SpectrumPeak { Mass = 314.26651, Intensity =147, },
                    new SpectrumPeak { Mass = 327.22346, Intensity =11, },
                    new SpectrumPeak { Mass = 327.25874, Intensity =184, },
                    new SpectrumPeak { Mass = 328.25819, Intensity =1045, },
                    new SpectrumPeak { Mass = 328.77596, Intensity =11, },
                    new SpectrumPeak { Mass = 329.00159, Intensity =370, },
                    new SpectrumPeak { Mass = 329.27517, Intensity =6495, },
                    new SpectrumPeak { Mass = 330.66662, Intensity =11, },
                    new SpectrumPeak { Mass = 330.68636, Intensity =311, },
                    new SpectrumPeak { Mass = 331.10715, Intensity =11, },
                    new SpectrumPeak { Mass = 331.15551, Intensity =167, },
                    new SpectrumPeak { Mass = 331.8563, Intensity =11, },
                    new SpectrumPeak { Mass = 333.42153, Intensity =11, },
                    new SpectrumPeak { Mass = 333.50077, Intensity =217, },
                    new SpectrumPeak { Mass = 334.16255, Intensity =11, },
                    new SpectrumPeak { Mass = 335.61115, Intensity =11, },
                    new SpectrumPeak { Mass = 336.95497, Intensity =11, },
                    new SpectrumPeak { Mass = 344.28507, Intensity =116, },
                    new SpectrumPeak { Mass = 345.28751, Intensity =622, },
                    new SpectrumPeak { Mass = 345.6642, Intensity =11, },
                    new SpectrumPeak { Mass = 346.30114, Intensity =7424, },
                    new SpectrumPeak { Mass = 347.7328, Intensity =11, },
                    new SpectrumPeak { Mass = 348.05488, Intensity =56, },
                    new SpectrumPeak { Mass = 348.59933, Intensity =288, },
                    new SpectrumPeak { Mass = 349.65329, Intensity =216, },
                }
            };
            var parser = FacadeLipidParser.Default;
            ILipid lipid = parser.Parse("MG 16:1");
            var generator = new MGSpectrumGenerator();
            var scan = lipid.GenerateSpectrum(generator, AdductIonParser.GetAdductIonBean("[M+NH4]+"));
            var reference = new MoleculeMsReference()
            {
                AdductType = AdductIon.GetAdductIon("[M+NH4]+"),
                Charge =1,
                CompoundClass ="MG",
                Spectrum = scan.Spectrum,
            };
            var result = MGEadMsCharacterization.Characterize(target, (Lipid)lipid, reference, 0.025f, 0, 2000);
            Console.WriteLine($"{result}");
        }
        [TestMethod()]
        public void LPId5EieioCharacterizationTest()
        {
            var target = new MSScanProperty
            {
                PrecursorMz = 564.31732,
                Spectrum = new List<SpectrumPeak>
                {
                    new SpectrumPeak { Mass = 100.99406, Intensity =7, },
                    new SpectrumPeak { Mass = 102.00475, Intensity =10, },
                    new SpectrumPeak { Mass = 126.02645, Intensity =21, },
                    new SpectrumPeak { Mass = 132.01767, Intensity =10, },
                    new SpectrumPeak { Mass = 134.08694, Intensity =68, },
                    new SpectrumPeak { Mass = 134.98231, Intensity =16, },
                    new SpectrumPeak { Mass = 141.02239, Intensity =72, },
                    new SpectrumPeak { Mass = 141.92649, Intensity =53, },
                    new SpectrumPeak { Mass = 143.03917, Intensity =15, },
                    new SpectrumPeak { Mass = 144.01021, Intensity =18, },
                    new SpectrumPeak { Mass = 144.0375, Intensity =242, },
                    new SpectrumPeak { Mass = 145.96982, Intensity =56, },
                    new SpectrumPeak { Mass = 147.08456, Intensity =10, },
                    new SpectrumPeak { Mass = 148.10119, Intensity =91, },
                    new SpectrumPeak { Mass = 149.10418, Intensity =10, },
                    new SpectrumPeak { Mass = 150.97683, Intensity =15, },
                    new SpectrumPeak { Mass = 154.13074, Intensity =10, },
                    new SpectrumPeak { Mass = 158.02517, Intensity =13, },
                    new SpectrumPeak { Mass = 159.03484, Intensity =110, },
                    new SpectrumPeak { Mass = 160.04494, Intensity =1472, },
                    new SpectrumPeak { Mass = 162.05616, Intensity =66, },
                    new SpectrumPeak { Mass = 163.05649, Intensity =62, },
                    new SpectrumPeak { Mass = 168.14917, Intensity =17, },
                    new SpectrumPeak { Mass = 171.00242, Intensity =38, },
                    new SpectrumPeak { Mass = 172.17097, Intensity =10, },
                    new SpectrumPeak { Mass = 174.14726, Intensity =10, },
                    new SpectrumPeak { Mass = 175.03119, Intensity =17, },
                    new SpectrumPeak { Mass = 176.13272, Intensity =22, },
                    new SpectrumPeak { Mass = 177.03572, Intensity =10, },
                    new SpectrumPeak { Mass = 177.06739, Intensity =10, },
                    new SpectrumPeak { Mass = 178.0525, Intensity =748, },
                    new SpectrumPeak { Mass = 181.99804, Intensity =6, },
                    new SpectrumPeak { Mass = 185.04574, Intensity =10, },
                    new SpectrumPeak { Mass = 188.03235, Intensity =10, },
                    new SpectrumPeak { Mass = 188.17478, Intensity =10, },
                    new SpectrumPeak { Mass = 189.06672, Intensity =7, },
                    new SpectrumPeak { Mass = 190.1466, Intensity =119, },
                    new SpectrumPeak { Mass = 190.96006, Intensity =8, },
                    new SpectrumPeak { Mass = 191.15517, Intensity =10, },
                    new SpectrumPeak { Mass = 195.07469, Intensity =10, },
                    new SpectrumPeak { Mass = 195.17415, Intensity =7, },
                    new SpectrumPeak { Mass = 200.00636, Intensity =13, },
                    new SpectrumPeak { Mass = 201.04112, Intensity =73, },
                    new SpectrumPeak { Mass = 202.05307, Intensity =223, },
                    new SpectrumPeak { Mass = 204.16257, Intensity =28, },
                    new SpectrumPeak { Mass = 204.95001, Intensity =10, },
                    new SpectrumPeak { Mass = 205.18479, Intensity =15, },
                    new SpectrumPeak { Mass = 205.97353, Intensity =5, },
                    new SpectrumPeak { Mass = 207.20866, Intensity =10, },
                    new SpectrumPeak { Mass = 213.04383, Intensity =6, },
                    new SpectrumPeak { Mass = 214.05013, Intensity =237, },
                    new SpectrumPeak { Mass = 216.03572, Intensity =10, },
                    new SpectrumPeak { Mass = 216.19326, Intensity =21, },
                    new SpectrumPeak { Mass = 217.06652, Intensity =10, },
                    new SpectrumPeak { Mass = 218.17852, Intensity =19, },
                    new SpectrumPeak { Mass = 219.18334, Intensity =10, },
                    new SpectrumPeak { Mass = 220.06003, Intensity =18, },
                    new SpectrumPeak { Mass = 223.19365, Intensity =108, },
                    new SpectrumPeak { Mass = 224.21456, Intensity =5, },
                    new SpectrumPeak { Mass = 225.22046, Intensity =76, },
                    new SpectrumPeak { Mass = 226.0224, Intensity =101, },
                    new SpectrumPeak { Mass = 226.23175, Intensity =5, },
                    new SpectrumPeak { Mass = 228.0686, Intensity =17, },
                    new SpectrumPeak { Mass = 230.04643, Intensity =31, },
                    new SpectrumPeak { Mass = 230.21147, Intensity =18, },
                    new SpectrumPeak { Mass = 231.01019, Intensity =10, },
                    new SpectrumPeak { Mass = 232.19453, Intensity =19, },
                    new SpectrumPeak { Mass = 233.20069, Intensity =20, },
                    new SpectrumPeak { Mass = 240.03396, Intensity =6, },
                    new SpectrumPeak { Mass = 242.24427, Intensity =10, },
                    new SpectrumPeak { Mass = 243.025, Intensity =68, },
                    new SpectrumPeak { Mass = 244.02923, Intensity =20, },
                    new SpectrumPeak { Mass = 244.0928, Intensity =10, },
                    new SpectrumPeak { Mass = 246.21018, Intensity =35, },
                    new SpectrumPeak { Mass = 247.21636, Intensity =15, },
                    new SpectrumPeak { Mass = 256.09918, Intensity =23, },
                    new SpectrumPeak { Mass = 258.19587, Intensity =8, },
                    new SpectrumPeak { Mass = 259.21425, Intensity =13, },
                    new SpectrumPeak { Mass = 260.22808, Intensity =59, },
                    new SpectrumPeak { Mass = 261.03558, Intensity =1005, },
                    new SpectrumPeak { Mass = 262.04455, Intensity =78, },
                    new SpectrumPeak { Mass = 270.11214, Intensity =70, },
                    new SpectrumPeak { Mass = 272.25692, Intensity =173, },
                    new SpectrumPeak { Mass = 273.15516, Intensity =17, },
                    new SpectrumPeak { Mass = 274.07018, Intensity =23, },
                    new SpectrumPeak { Mass = 274.24173, Intensity =26, },
                    new SpectrumPeak { Mass = 274.27209, Intensity =26, },
                    new SpectrumPeak { Mass = 276.05316, Intensity =52, },
                    new SpectrumPeak { Mass = 278.07094, Intensity =10, },
                    new SpectrumPeak { Mass = 281.04737, Intensity =12, },
                    new SpectrumPeak { Mass = 282.15468, Intensity =177, },
                    new SpectrumPeak { Mass = 284.12723, Intensity =10, },
                    new SpectrumPeak { Mass = 286.07391, Intensity =10, },
                    new SpectrumPeak { Mass = 286.14019, Intensity =10, },
                    new SpectrumPeak { Mass = 287.28625, Intensity =5, },
                    new SpectrumPeak { Mass = 288.25724, Intensity =23, },
                    new SpectrumPeak { Mass = 298.14842, Intensity =34, },
                    new SpectrumPeak { Mass = 301.26645, Intensity =10, },
                    new SpectrumPeak { Mass = 302.27364, Intensity =153, },
                    new SpectrumPeak { Mass = 303.28181, Intensity =255, },
                    new SpectrumPeak { Mass = 304.28715, Intensity =440, },
                    new SpectrumPeak { Mass = 305.09613, Intensity =30, },
                    new SpectrumPeak { Mass = 306.08048, Intensity =178, },
                    new SpectrumPeak { Mass = 312.16481, Intensity =11, },
                    new SpectrumPeak { Mass = 314.16901, Intensity =15, },
                    new SpectrumPeak { Mass = 320.08045, Intensity =40, },
                    new SpectrumPeak { Mass = 321.08275, Intensity =11, },
                    new SpectrumPeak { Mass = 322.09513, Intensity =100, },
                    new SpectrumPeak { Mass = 323.09971, Intensity =58, },
                    new SpectrumPeak { Mass = 326.17614, Intensity =10, },
                    new SpectrumPeak { Mass = 337.08595, Intensity =15, },
                    new SpectrumPeak { Mass = 340.10162, Intensity =215, },
                    new SpectrumPeak { Mass = 341.19852, Intensity =6, },
                    new SpectrumPeak { Mass = 342.20087, Intensity =35, },
                    new SpectrumPeak { Mass = 354.20451, Intensity =6, },
                    new SpectrumPeak { Mass = 356.22245, Intensity =105, },
                    new SpectrumPeak { Mass = 358.09782, Intensity =10, },
                    new SpectrumPeak { Mass = 366.2357, Intensity =7, },
                    new SpectrumPeak { Mass = 376.09973, Intensity =24, },
                    new SpectrumPeak { Mass = 382.2309, Intensity =11, },
                    new SpectrumPeak { Mass = 383.24709, Intensity =55, },
                    new SpectrumPeak { Mass = 384.2536, Intensity =1068, },
                    new SpectrumPeak { Mass = 390.12, Intensity =8, },
                    new SpectrumPeak { Mass = 394.11264, Intensity =20, },
                    new SpectrumPeak { Mass = 402.26375, Intensity =143, },
                    new SpectrumPeak { Mass = 414.14987, Intensity =71, },
                    new SpectrumPeak { Mass = 426.28524, Intensity =11, },
                    new SpectrumPeak { Mass = 432.16474, Intensity =17, },
                    new SpectrumPeak { Mass = 438.24956, Intensity =11, },
                    new SpectrumPeak { Mass = 439.27472, Intensity =18, },
                    new SpectrumPeak { Mass = 453.26246, Intensity =26, },
                    new SpectrumPeak { Mass = 453.28699, Intensity =11, },
                    new SpectrumPeak { Mass = 454.26466, Intensity =28, },
                    new SpectrumPeak { Mass = 463.29258, Intensity =11, },
                    new SpectrumPeak { Mass = 475.21929, Intensity =11, },
                    new SpectrumPeak { Mass = 481.28659, Intensity =13, },
                    new SpectrumPeak { Mass = 484.23278, Intensity =6, },
                    new SpectrumPeak { Mass = 502.24623, Intensity =10, },
                    new SpectrumPeak { Mass = 516.25366, Intensity =11, },
                    new SpectrumPeak { Mass = 516.29818, Intensity =11, },
                    new SpectrumPeak { Mass = 526.27565, Intensity =11, },
                    new SpectrumPeak { Mass = 527.2925, Intensity =83, },
                    new SpectrumPeak { Mass = 528.29766, Intensity =17, },
                    new SpectrumPeak { Mass = 544.29019, Intensity =11, },
                    new SpectrumPeak { Mass = 545.30064, Intensity =122, },
                    new SpectrumPeak { Mass = 546.30863, Intensity =2609, },
                    new SpectrumPeak { Mass = 563.30711, Intensity =121, },
                    new SpectrumPeak { Mass = 564.31948, Intensity =1789, },
                }
            };
            var parser = FacadeLipidParser.Default;
            ILipid lipid = parser.Parse("LPI_d5 15:0/0:0");
            var generator = new LPId5SpectrumGenerator();
            var scan = lipid.GenerateSpectrum(generator, AdductIonParser.GetAdductIonBean("[M+H]+"));
            var reference = new MoleculeMsReference()
            {
                AdductType = AdductIon.GetAdductIon("[M+H]+"),
                Charge = 1,
                CompoundClass = "\"LPI_d5",
                Spectrum = scan.Spectrum,
            };
            var result = LPIEadMsCharacterization.Characterize(target, (Lipid)lipid, reference, 0.025f, 0, 2000);
            Console.WriteLine($"{result}");
        }

    }
}
