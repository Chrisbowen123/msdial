<Window x:Class="MsdialDimsCoreUiTestApp.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:converter="clr-namespace:CompMs.Graphics.Converter;assembly=ChartDrawing"
        xmlns:local="clr-namespace:MsdialDimsCoreUiTestApp"
        xmlns:view="clr-namespace:MsdialDimsCoreUiTestApp.View"
        xmlns:scm="clr-namespace:System.ComponentModel;assembly=WindowsBase"
        mc:Ignorable="d"
        x:Name="window"
        Title="MainWindow" Height="1200" Width="1500">
    <Window.DataContext>
        <local:MainWindowVM/>
    </Window.DataContext>
    <Window.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="/View/Resource.xaml" />
            </ResourceDictionary.MergedDictionaries>
            <converter:AreEqualsConverter x:Key="Eq" />
            <CollectionViewSource x:Key="detects"
                                  Source="{Binding DataContext.Ms2Features/Detected, Source={x:Reference window}}">
                <CollectionViewSource.SortDescriptions>
                    <scm:SortDescription PropertyName="Score" Direction="Descending"/>
                </CollectionViewSource.SortDescriptions>
            </CollectionViewSource>
            <ControlTemplate TargetType="ListBox" x:Key="ListBoxWithHeader">
                <StackPanel>
                    <TextBlock Text="{Binding}" />
                    <ContentPresenter/>
                </StackPanel>
            </ControlTemplate>
        </ResourceDictionary>
    </Window.Resources>
    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="1*"/>
            <ColumnDefinition Width="1*"/>
            <ColumnDefinition Width="6*"/>
            <ColumnDefinition Width="2*"/>
        </Grid.ColumnDefinitions>
        <Grid.RowDefinitions>
            <RowDefinition/>
            <RowDefinition/>
        </Grid.RowDefinitions>

        <!-- File Navigator -->
        <Grid Grid.Row="0" Grid.Column="0">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition />
            </Grid.RowDefinitions>
            <TextBlock Text="File navigator"
                       Height="20" Grid.Row="0"/>
            <ListBox ItemsSource="{Binding AnalysisFiles}" Grid.Row="1"/>
        </Grid>

        <!-- Alignment Navigator -->
        <Grid Grid.Row="1" Grid.Column="0">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition />
            </Grid.RowDefinitions>
            <TextBlock Text="Alignment navigator"
                       Height="20" Grid.Row="0"/>
            <ListBox ItemsSource="{Binding AlignmentFiles}" Grid.Row="1"/>
        </Grid>

        <!-- Ms1 spectrum -->
        <view:MS1Control Margin="0,5,5,0"
                         Grid.Column="2" Grid.Row="0" />

        <!-- Peak selector -->
        <ListBox ItemsSource="{Binding Ms2Features}"
                 IsSynchronizedWithCurrentItem="True"
                 Grid.Column="1" Grid.Row="0" Grid.RowSpan="2"/>

        <!-- Ms2 spectrum -->
        <view:MS2RawSpectrumControl SelectedDetection="{Binding SelectedItems, ElementName=Ms2Anno}"
                                    Margin="0,0,5,5"
                                    Grid.Row="1" Grid.Column="2"/>

        <!-- Annotation selector -->
        <ListView x:Name="Ms2Anno"
                  ItemsSource="{Binding Source={StaticResource detects}}"
                  SelectionMode="Extended"
                  Grid.Column="3" Grid.Row="1" >
            <ListView.Resources>
                <Style TargetType="ListViewItem">
                    <Setter Property="HorizontalContentAlignment" Value="Stretch" />
                </Style>
            </ListView.Resources>
            <ListView.View>
                <GridView>
                    <GridViewColumn DisplayMemberBinding="{Binding Result.TotalScore, StringFormat={}{0:N2}}"
                                    Header="Score" Width="Auto"/>
                    <GridViewColumn DisplayMemberBinding="{Binding Reference.Name}" Width="Auto"/>
                </GridView>
            </ListView.View>
        </ListView>

        <!-- Annotation detailview -->
        <ListBox ItemsSource="{Binding SelectedItems, ElementName=Ms2Anno}"
                 ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                 Grid.Column="3" Grid.Row="0">
            <ListBox.ItemTemplate>
                <DataTemplate>
                    <ContentControl Content="{Binding Reference}" />
                </DataTemplate>
            </ListBox.ItemTemplate>
        </ListBox>
    </Grid>
</Window>
